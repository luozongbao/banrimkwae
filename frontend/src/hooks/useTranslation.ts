import { useState, useEffect } from 'react';

const translations = {
  en: {
    common: {
      language: 'Language',
      resortName: 'BANRIMKWAE RESORT',
      loading: 'Loading...',
      save: 'Save',
      cancel: 'Cancel',
      edit: 'Edit',
      delete: 'Delete',
      add: 'Add',
      search: 'Search',
      filter: 'Filter',
      export: 'Export',
      import: 'Import',
      actions: 'Actions',
      status: 'Status',
      active: 'Active',
      inactive: 'Inactive',
      pending: 'Pending',
      suspended: 'Suspended',
      all: 'All',
      yes: 'Yes',
      no: 'No',
      confirm: 'Confirm',
      upload: 'Upload',
      download: 'Download',
      refresh: 'Refresh',
      reset: 'Reset',
      clear: 'Clear',
      apply: 'Apply',
      close: 'Close',
      back: 'Back',
      next: 'Next',
      previous: 'Previous',
      page: 'Page',
      of: 'of',
      items: 'items',
      showing: 'Showing',
      to: 'to',
      results: 'results',
      noResults: 'No results found',
      selectFile: 'Select File',
      dropFile: 'Drop file here',
      or: 'or',
      clickToUpload: 'click to upload',
      fileUploaded: 'File uploaded successfully',
      uploadFailed: 'Upload failed',
      generate: 'Generate',
      copy: 'Copy',
      copied: 'Copied',
    },
    auth: {
      managementSystem: 'Management System',
      loginToSystem: 'LOGIN TO SYSTEM',
      emailOrUsername: 'Email/Username',
      password: 'Password',
      rememberMe: 'Remember me',
      login: 'Login',
      loggingIn: 'Logging in...',
      forgotPassword: 'Forgot Password?',
      needHelp: 'Need Help?',
      enterEmail: 'Enter your email',
      enterPassword: 'Enter your password',
      logout: 'Logout',
    },
    users: {
      title: 'User Management',
      subtitle: 'Manage system users, roles, and permissions',
      addUser: 'Add User',
      editUser: 'Edit User',
      deleteUser: 'Delete User',
      deleteUsers: 'Delete Users',
      exportUsers: 'Export Users',
      importUsers: 'Import Users',
      userProfile: 'User Profile',
      profile: 'Profile',
      security: 'Security',
      activity: 'Activity',
      personalInfo: 'Personal Information',
      contactInfo: 'Contact Information',
      accountSettings: 'Account Settings',
      profilePicture: 'Profile Picture',
      changePassword: 'Change Password',
      currentPassword: 'Current Password',
      newPassword: 'New Password',
      confirmPassword: 'Confirm Password',
      passwordChanged: 'Password changed successfully',
      firstName: 'First Name',
      lastName: 'Last Name',
      email: 'Email',
      phone: 'Phone',
      role: 'Role',
      department: 'Department',
      position: 'Position',
      isActive: 'Is Active',
      lastLogin: 'Last Login',
      createdAt: 'Created At',
      searchUsers: 'Search users...',
      filterByRole: 'Filter by Role',
      filterByDepartment: 'Filter by Department',
      filterByStatus: 'Filter by Status',
      bulkActions: 'Bulk Actions',
      selectedUsers: 'Selected Users',
      selectAll: 'Select All',
      deselectAll: 'Deselect All',
      activateUsers: 'Activate Users',
      deactivateUsers: 'Deactivate Users',
      assignRole: 'Assign Role',
      userCreated: 'User created successfully',
      userUpdated: 'User updated successfully',
      userDeleted: 'User deleted successfully',
      usersDeleted: 'Users deleted successfully',
      usersActivated: 'Users activated successfully',
      usersDeactivated: 'Users deactivated successfully',
      roleAssigned: 'Role assigned successfully',
      confirmDeleteUser: 'Are you sure you want to delete this user?',
      confirmDeleteUsers: 'Are you sure you want to delete {count} users?',
      confirmActivateUsers: 'Are you sure you want to activate {count} users?',
      confirmDeactivateUsers: 'Are you sure you want to deactivate {count} users?',
      noUsersSelected: 'No users selected',
      userNotFound: 'User not found',
      cannotDeleteSelf: 'You cannot delete your own account',
      cannotDeactivateSelf: 'You cannot deactivate your own account',
      uploadUserPhoto: 'Upload user photo',
      removePhoto: 'Remove photo',
      photoUploaded: 'Photo uploaded successfully',
      photoRemoved: 'Photo removed successfully',
      generatePassword: 'Generate Password',
      passwordGenerated: 'Password generated',
      passwordCopied: 'Password copied to clipboard',
      showPassword: 'Show password',
      hidePassword: 'Hide password',
      activityLog: 'Activity Log',
      noActivityLog: 'No activity logged yet',
      login: 'Login',
      logout: 'Logout',
      passwordChange: 'Password Change',
      profileUpdate: 'Profile Update',
      permissionChange: 'Permission Change',
      ipAddress: 'IP Address',
      userAgent: 'User Agent',
      sessionDetails: 'Session Details',
      totalUsers: 'Total Users',
      activeUsers: 'Active Users',
      inactiveUsers: 'Inactive Users',
      recentUsers: 'Recent Users',
    },
    validation: {
      required: '{field} is required',
      invalidEmail: 'Please enter a valid email address',
      minLength: '{field} must be at least {length} characters',
      maxLength: '{field} must be at most {length} characters',
      passwordMismatch: 'Passwords do not match',
      invalidPhone: 'Please enter a valid phone number',
      invalidFile: 'Please select a valid file',
      fileTooLarge: 'File size must be less than {size}MB',
      invalidFileType: 'Invalid file type. Allowed types: {types}',
    },
  },
  th: {
    common: {
      language: 'ภาษา',
      resortName: 'บ้านริมแคว รีสอร์ท',
      loading: 'กำลังโหลด...',
      save: 'บันทึก',
      cancel: 'ยกเลิก',
      edit: 'แก้ไข',
      delete: 'ลบ',
      add: 'เพิ่ม',
      search: 'ค้นหา',
      filter: 'กรอง',
      export: 'ส่งออก',
      import: 'นำเข้า',
      actions: 'การกระทำ',
      status: 'สถานะ',
      active: 'ใช้งาน',
      inactive: 'ไม่ใช้งาน',
      pending: 'รอดำเนินการ',
      suspended: 'ระงับ',
      all: 'ทั้งหมด',
      yes: 'ใช่',
      no: 'ไม่',
      confirm: 'ยืนยัน',
      upload: 'อัปโหลด',
      download: 'ดาวน์โหลด',
      refresh: 'รีเฟรช',
      reset: 'รีเซ็ต',
      clear: 'ล้าง',
      apply: 'ใช้',
      close: 'ปิด',
      back: 'กลับ',
      next: 'ถัดไป',
      previous: 'ก่อนหน้า',
      page: 'หน้า',
      of: 'จาก',
      items: 'รายการ',
      showing: 'แสดง',
      to: 'ถึง',
      results: 'ผลลัพธ์',
      noResults: 'ไม่พบผลลัพธ์',
      selectFile: 'เลือกไฟล์',
      dropFile: 'วางไฟล์ที่นี่',
      or: 'หรือ',
      clickToUpload: 'คลิกเพื่ออัปโหลด',
      fileUploaded: 'อัปโหลดไฟล์สำเร็จ',
      uploadFailed: 'อัปโหลดไม่สำเร็จ',
      generate: 'สร้าง',
      copy: 'คัดลอก',
      copied: 'คัดลอกแล้ว',
    },
    auth: {
      managementSystem: 'ระบบจัดการ',
      loginToSystem: 'เข้าสู่ระบบ',
      emailOrUsername: 'อีเมล/ชื่อผู้ใช้',
      password: 'รหัสผ่าน',
      rememberMe: 'จดจำฉันไว้',
      login: 'เข้าสู่ระบบ',
      loggingIn: 'กำลังเข้าสู่ระบบ...',
      forgotPassword: 'ลืมรหัสผ่าน?',
      needHelp: 'ต้องการความช่วยเหลือ?',
      enterEmail: 'กรอกอีเมลของคุณ',
      enterPassword: 'กรอกรหัสผ่านของคุณ',
      logout: 'ออกจากระบบ',
    },
    users: {
      title: 'จัดการผู้ใช้',
      subtitle: 'จัดการผู้ใช้ระบบ บทบาท และสิทธิ์',
      addUser: 'เพิ่มผู้ใช้',
      editUser: 'แก้ไขผู้ใช้',
      deleteUser: 'ลบผู้ใช้',
      deleteUsers: 'ลบผู้ใช้',
      exportUsers: 'ส่งออกข้อมูลผู้ใช้',
      importUsers: 'นำเข้าข้อมูลผู้ใช้',
      userProfile: 'โปรไฟล์ผู้ใช้',
      profile: 'โปรไฟล์',
      security: 'ความปลอดภัย',
      activity: 'กิจกรรม',
      personalInfo: 'ข้อมูลส่วนตัว',
      contactInfo: 'ข้อมูลติดต่อ',
      accountSettings: 'การตั้งค่าบัญชี',
      profilePicture: 'รูปโปรไฟล์',
      changePassword: 'เปลี่ยนรหัสผ่าน',
      currentPassword: 'รหัสผ่านปัจจุบัน',
      newPassword: 'รหัสผ่านใหม่',
      confirmPassword: 'ยืนยันรหัสผ่าน',
      passwordChanged: 'เปลี่ยนรหัสผ่านสำเร็จ',
      firstName: 'ชื่อ',
      lastName: 'นามสกุล',
      email: 'อีเมล',
      phone: 'โทรศัพท์',
      role: 'บทบาท',
      department: 'แผนก',
      position: 'ตำแหน่ง',
      isActive: 'ใช้งาน',
      lastLogin: 'เข้าสู่ระบบล่าสุด',
      createdAt: 'วันที่สร้าง',
      searchUsers: 'ค้นหาผู้ใช้...',
      filterByRole: 'กรองตามบทบาท',
      filterByDepartment: 'กรองตามแผนก',
      filterByStatus: 'กรองตามสถานะ',
      bulkActions: 'การกระทำแบบกลุ่ม',
      selectedUsers: 'ผู้ใช้ที่เลือก',
      selectAll: 'เลือกทั้งหมด',
      deselectAll: 'ยกเลิกการเลือก',
      activateUsers: 'เปิดใช้งานผู้ใช้',
      deactivateUsers: 'ปิดใช้งานผู้ใช้',
      assignRole: 'กำหนดบทบาท',
      userCreated: 'สร้างผู้ใช้สำเร็จ',
      userUpdated: 'อัปเดตผู้ใช้สำเร็จ',
      userDeleted: 'ลบผู้ใช้สำเร็จ',
      usersDeleted: 'ลบผู้ใช้สำเร็จ',
      usersActivated: 'เปิดใช้งานผู้ใช้สำเร็จ',
      usersDeactivated: 'ปิดใช้งานผู้ใช้สำเร็จ',
      roleAssigned: 'กำหนดบทบาทสำเร็จ',
      confirmDeleteUser: 'คุณแน่ใจหรือไม่ว่าต้องการลบผู้ใช้นี้?',
      confirmDeleteUsers: 'คุณแน่ใจหรือไม่ว่าต้องการลบผู้ใช้ {count} คน?',
      confirmActivateUsers: 'คุณแน่ใจหรือไม่ว่าต้องการเปิดใช้งานผู้ใช้ {count} คน?',
      confirmDeactivateUsers: 'คุณแน่ใจหรือไม่ว่าต้องการปิดใช้งานผู้ใช้ {count} คน?',
      noUsersSelected: 'ไม่ได้เลือกผู้ใช้',
      userNotFound: 'ไม่พบผู้ใช้',
      cannotDeleteSelf: 'คุณไม่สามารถลบบัญชีของตัวเองได้',
      cannotDeactivateSelf: 'คุณไม่สามารถปิดใช้งานบัญชีของตัวเองได้',
      uploadUserPhoto: 'อัปโหลดรูปผู้ใช้',
      removePhoto: 'ลบรูป',
      photoUploaded: 'อัปโหลดรูปสำเร็จ',
      photoRemoved: 'ลบรูปสำเร็จ',
      generatePassword: 'สร้างรหัสผ่าน',
      passwordGenerated: 'สร้างรหัสผ่านแล้ว',
      passwordCopied: 'คัดลอกรหัสผ่านแล้ว',
      showPassword: 'แสดงรหัสผ่าน',
      hidePassword: 'ซ่อนรหัสผ่าน',
      activityLog: 'บันทึกกิจกรรม',
      noActivityLog: 'ยังไม่มีกิจกรรมที่บันทึก',
      login: 'เข้าสู่ระบบ',
      logout: 'ออกจากระบบ',
      passwordChange: 'เปลี่ยนรหัสผ่าน',
      profileUpdate: 'อัปเดตโปรไฟล์',
      permissionChange: 'เปลี่ยนสิทธิ์',
      ipAddress: 'ที่อยู่ IP',
      userAgent: 'User Agent',
      sessionDetails: 'รายละเอียดเซสชัน',
      totalUsers: 'ผู้ใช้ทั้งหมด',
      activeUsers: 'ผู้ใช้ที่ใช้งาน',
      inactiveUsers: 'ผู้ใช้ที่ไม่ใช้งาน',
      recentUsers: 'ผู้ใช้ล่าสุด',
    },
    validation: {
      required: 'กรุณากรอก{field}',
      invalidEmail: 'กรุณากรอกอีเมลที่ถูกต้อง',
      minLength: '{field}ต้องมีอย่างน้อย {length} ตัวอักษร',
      maxLength: '{field}ต้องมีไม่เกิน {length} ตัวอักษร',
      passwordMismatch: 'รหัสผ่านไม่ตรงกัน',
      invalidPhone: 'กรุณากรอกหมายเลขโทรศัพท์ที่ถูกต้อง',
      invalidFile: 'กรุณาเลือกไฟล์ที่ถูกต้อง',
      fileTooLarge: 'ขนาดไฟล์ต้องน้อยกว่า {size}MB',
      invalidFileType: 'ประเภทไฟล์ไม่ถูกต้อง ประเภทที่อนุญาต: {types}',
    },
  },
};

export const useTranslation = () => {
  const [currentLanguage, setCurrentLanguage] = useState<'en' | 'th'>(() => {
    return (localStorage.getItem('language') as 'en' | 'th') || 'en';
  });

  useEffect(() => {
    localStorage.setItem('language', currentLanguage);
    document.documentElement.lang = currentLanguage;
  }, [currentLanguage]);

  const t = (key: string, params?: Record<string, string | number>): string => {
    const keys = key.split('.');
    let value: any = translations[currentLanguage];

    for (const k of keys) {
      value = value?.[k];
    }

    if (typeof value !== 'string') {
      return key; // Return key if translation not found
    }

    // Replace parameters
    if (params) {
      return Object.entries(params).reduce((str, [paramKey, paramValue]) => {
        return str.replace(new RegExp(`{${paramKey}}`, 'g'), String(paramValue));
      }, value);
    }

    return value;
  };

  const switchLanguage = (language: 'en' | 'th') => {
    setCurrentLanguage(language);
  };

  return {
    t,
    currentLanguage,
    switchLanguage,
  };
};
